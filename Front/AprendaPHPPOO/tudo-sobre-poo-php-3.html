<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <meta charset="UTF-8"/>
        <link rel="icon" href="imagens/favicon.ico"/>
        <title>Aprenda POO PHP</title>
        <link rel="stylesheet" href="css/estilo.css"/>
    </head>
    <body>
        <div>
            <header>
                <h1>Aprenda POO PHP</h1>
                <menu>
                    <li><a href="index.html">Página Inicial</a></li>
                    <li><a href="contato.html">Contato!</a></li>
                    <li><a href="tudo-sobre-poo-php-1.html">Tudo sobre POO PHP Parte 1!</a></li>
                    <li><a href="tudo-sobre-poo-php-2.html">Tudo sobre POO PHP Parte 2!</a></li>
                    <li><a href="tudo-sobre-poo-php-3.html" onclick="alert('Você já Está na Matéria desse Link!'); return false">Tudo sobre POO PHP Parte 3!</a></li>
                    <li><a href="tudo-sobre-poo-php-4.html">Tudo sobre POO PHP Parte 4!</a></li>
                    <li><a href="tudo-sobre-poo-php-5.html">Tudo sobre POO PHP Parte 5!</a></li>
                    <li><a href="tudo-sobre-poo-php-6.html">Tudo sobre POO PHP Parte 6!</a></li>
                    <li><a href="tudo-sobre-poo-php-7.html">Tudo sobre POO PHP Parte 7!</a></li>
                </menu>
            </header>
            
<h2>Tudo sobre Poo PHP Parte 3</h2>

<h3>Objetos Compostos em PHP</h3>

<p>Para fazermos um relacionamento entre classes, vamos supor o Objeto lutador, com esses atributos e métodos e suas visibilidades:</p>

<table>
    <tr>
        <th>Lutador</th>
    </tr>
    <tr>
        <td>
            - nome: String<br/>
            - nacionalidade: String<br/>
            - idade: int<br/>
            - altura: float<br/>
            - peso: float<br/>
            - categoria: String<br/>
            - vitórias: int<br/>
            - derrotas: int<br/>
            - empates: int<br/>
        </td>
    </tr>
    <tr>
        <td>
            + apresentar(): void<br/>
            + status(): void<br/>
            + ganharLuta(): void<br/>
            + perderLuta(): void<br/>
            + empatarLuta(): void<br/>
        </td>
    </tr>
</table>

<p>Crie uma classe com o nome Lutador.php, com esse código:</p>

<pre>
<code>
class Lutador {
    private $nome;
    private $nacionalidade;
    private $idade;
    private $altura;
    private $peso;
    private $categoria;
    private $vitorias;
    private $derrotas;
    private $empates;
    
    public function apresentar() {
        echo "&lt;p&gt;-------------------------------&lt;/p&gt;";
        echo "&lt;p&gt;CHEGOU A HORA! O lutador " . $this-&gt;getNome();
        echo " veio diretamente de " . $this-&gt;getNacionalidade();
        echo ", tem " . $this-&gt;getIdade() . " anos e pesa " . $this-&gt;getPeso() . "Kg.";
        echo "&lt;br/&gt;Ele tem " . $this-&gt;getVitorias() . " vitórias, ";
        echo $this-&gt;getDerrotas() . " derrotas e " . $this-&gt;getEmpates() . " empates.&lt;/p&gt;";
    }
    public function status() {
        echo "&lt;p&gt;-------------------------------&lt;/p&gt;";
        echo "&lt;p&gt;" . $this-&gt;getNome() . " é um peso " . $this-&gt;getCategoria();
        echo " e já ganhou " . $this-&gt;getVitorias() . " vezes, ";
        echo " perdeu " . $this-&gt;getDerrotas() . " vezes e ";
        echo " empatou " . $this-&gt;getEmpates() . " vezes.&lt;/p&gt;";
        
    }
    public function ganharLuta() {
        $this-&gt;setVitorias($this-&gt;getVitorias() + 1);
        // $this-&gt;vitorias = $this-&gt;vitorias + 1;
    }
    public function perderLuta() {
        $this-&gt;setDerrotas($this-&gt;getDerrotas() + 1);
    }
    public function empatarLuta() {
        $this-&gt;setEmpates($this-&gt;getEmpates() + 1);
    }
    
    public function __construct($no, $na, $id, $al, $pe, $vi, $de, $em) {
        $this-&gt;nome = $no;
        $this-&gt;nacionalidade = $na;
        $this-&gt;idade = $id;
        $this-&gt;altura = $al;
        $this-&gt;setPeso($pe);
        $this-&gt;vitorias = $vi;
        $this-&gt;derrotas = $de;
        $this-&gt;empates = $em;
    }
    public function getNome() {
        return $this-&gt;nome;
    }

    public function getNacionalidade() {
        return $this-&gt;nacionalidade;
    }

    public function getIdade() {
        return $this-&gt;idade;
    }

    public function getAltura() {
        return $this-&gt;altura;
    }

    public function getPeso() {
        return $this-&gt;peso;
    }

    public function getCategoria() {
        return $this-&gt;categoria;
    }

    public function getVitorias() {
        return $this-&gt;vitorias;
    }

    public function getDerrotas() {
        return $this-&gt;derrotas;
    }

    public function getEmpates() {
        return $this-&gt;empates;
    }

    public function setNome($nome) {
        $this-&gt;nome = $nome;
    }

    public function setNacionalidade($nacionalidade) {
        $this-&gt;nacionalidade = $nacionalidade;
    }

    public function setIdade($idade) {
        $this-&gt;idade = $idade;
    }

    public function setAltura($altura) {
        $this-&gt;altura = $altura;
    }

    public function setPeso($peso) {
        $this-&gt;peso = $peso;
        $this-&gt;setCategoria();
    }

    private function setCategoria() { // Esse não tem parâmetros
        if($this-&gt;peso &lt;= 52.2) {
            $this-&gt;categoria = "Inválido";
        }
        else if($this-&gt;peso &gt; 52.2 && $this-&gt;peso &lt;= 70.3) {
            $this-&gt;categoria = "Leve";
        }
        else if($this-&gt;peso &gt; 70.3 && $this-&gt;peso &lt;= 83.9) {
            $this-&gt;categoria = "Médio";
        }
        else if($this-&gt;peso &gt; 83.9 && $this-&gt;peso &lt;= 120.2) {
            $this-&gt;categoria = "Pesado";
        }
        else {
            $this-&gt;categoria = "Inválido";
        }
    }

    public function setVitorias($vitorias) {
        $this-&gt;vitorias = $vitorias;
    }

    public function setDerrotas($derrotas) {
        $this-&gt;derrotas = $derrotas;
    }

    public function setEmpates($empates) {
        $this-&gt;empates = $empates;
    }
}
</code>
</pre>

<p>Lembrando que no método construtor, não terá o atributo "categoria", pois ela será calculada automaticamente pelo nosso programa.</p>

<p>E no index, coloque isso:</p>

<pre>
<code>
require_once "Lutador.php";

$l = array(); // Uso de Array em PHP.

$l[0] = new Lutador("Pretty Boy", "França", 30, 1.75, 68.9, 11, 2, 1); // Precisa passar os parâmetros referentes.
$l[1] = new Lutador("Putscript", "Brasil", 29, 1.68, 57.8, 14, 2, 3);
$l[2] = new Lutador("SnapShadow", "EUA", 35, 1.65, 80.9, 12, 2, 1);
$l[3] = new Lutador("Dead Code", "Austrália", 28, 1.93, 81.6, 13, 0, 2);
$l[4] = new Lutador("UFOCobol", "Brasil", 37, 1.70, 119.3, 5, 4, 3);
$l[5] = new Lutador("Nerdaart", "EUA", 30, 1.81, 105.7, 12, 2, 4);

$l[0]-&gt;perderLuta();
$l[0]-&gt;apresentar();
$l[0]-&gt;status();
</code>
</pre>

<p>Nesse caso, um evento dispara outro evento e o segundo automaticamente configura um atributo. As variáveis foram colocadas em um array (que começa sempre com 0). A setCategoria() não pode ser chamada por ser privada.</p>

<p>Teste outros "lutadores", e os outros métodos.</p>

<h3>Agregação entre Objetos em PHP</h3>

<p>Continuando a aula anterior, com os lutadores, usaremos a agregação entre as classes, que é a relação entre uma classe e outra. Veja o diagrama da classe Luta:</p>

<table>
    <tr>
        <th>Luta</th>
    </tr>
    <tr>
        <td>
        - desafiado: Lutador<br/>
        - desafiante: Lutador<br/>
        - rounds: int<br/>
        - aprovada: boolean<br/>
        </td>
    </tr>
    <tr>
        <td> 
        + marcarLuta(l1: Lutador, l2: Lutador): void<br/>
        + lutar(): void<br/>
        </td>
    </tr>
</table>

<p>No caso, a classe Luta terá atributos e funções que farão a disputas entre eles.</p>

<p>A classe Lutador não será alterada, e o index só deixe a criação dos objetos (lutadores), sem as invocações das funções.</p>

<p>PS: Podemos criar várias classes dentro de um mesmo pacote (arquivo), mas não é recomendado. Dê a preferência de usar classes em arquivos separados pra facilitar o reuso.</p>

<p>Esse é o código da classe Luta.php, que deverá ser criada:</p>

<pre>
<code>
require_once "Lutador.php";

class Luta {
    private $desafiado;
    private $desafiante;
    private $rounds;
    private $aprovada;
    
    public function marcarLuta($l1, $l2) {
        if($l1-&gt;getCategoria() === $l2-&gt;getCategoria() && $l1 != $l2) {
            $this-&gt;aprovada = true;
            $this-&gt;desafiado = $l1;
            $this-&gt;desafiante = $l2;
        }
        else {
            $this-&gt;aprovada = false;
            $this-&gt;desafiado = null;
            $this-&gt;desafiante = null;
        }
    }
    public function lutar() {
        if($this-&gt;aprovada) {
            echo "&lt;### DESAFIADO ###&gt;";
            $this-&gt;desafiado-&gt;apresentar();
            echo "&lt;### DESAFIANTE ###&gt;";
            $this-&gt;desafiante-&gt;apresentar();
            $vencedor = rand(0, 2);
            
            switch($vencedor) {
                case 0:
                    // Empate
                    echo "&lt;p&gt;Empate!&lt;/p&gt;";
                    $this-&gt;desafiado-&gt;empatarLuta();
                    $this-&gt;desafiante-&gt;empatarLuta();
                    break;
                case 1:
                    // Desafiado Vence
                    echo "&lt;p&gt;" . $this-&gt;desafiado-&gt;getNome() . " vence!&lt;/p&gt;";
                    $this-&gt;desafiado-&gt;ganharLuta();
                    $this-&gt;desafiante-&gt;perderLuta();
                    break;
                case 2:
                    // Desafiante Vence
                    echo "&lt;p&gt;" . $this-&gt;desafiante-&gt;getNome() . " vence!&lt;/p&gt;";
                    $this-&gt;desafiado-&gt;perderLuta();
                    $this-&gt;desafiante-&gt;ganharLuta();
                    break;
                
            }
        }
        else {
            echo "&lt;p&gt;Luta não pode acontecer!&lt;/p&gt;";
        }
    }
    
    public function getDesafiado() {
        return $this-&gt;desafiado;
    }

    public function getDesafiante() {
        return $this-&gt;desafiante;
    }

    public function getRounds() {
        return $this-&gt;rounds;
    }

    public function getAprovada() {
        return $this-&gt;aprovada;
    }

    public function setDesafiado($desafiado) {
        $this-&gt;desafiado = $desafiado;
    }

    public function setDesafiante($desafiante) {
        $this-&gt;desafiante = $desafiante;
    }

    public function setRounds($rounds) {
        $this-&gt;rounds = $rounds;
    }

    public function setAprovada($aprovada) {
        $this-&gt;aprovada = $aprovada;
    }
}
</code>
</pre>

<p>E no index, basta colocar isso:</p>

<pre>
<code>
require_once "Luta.php"; // Não é necessário colocar também o Lutador.php

$l = array();

$l[0] = new Lutador("Pretty Boy", "França", 30, 1.75, 68.9, 11, 2, 1); // Precisa passar os parâmetros referentes
$l[1] = new Lutador("Putscript", "Brasil", 29, 1.68, 57.8, 14, 2, 3);
$l[2] = new Lutador("SnapShadow", "EUA", 35, 1.65, 80.9, 12, 2, 1);
$l[3] = new Lutador("Dead Code", "Austrália", 28, 1.93, 81.6, 13, 0, 2);
$l[4] = new Lutador("UFOCobol", "Brasil", 37, 1.70, 119.3, 5, 4, 3);
$l[5] = new Lutador("Nerdaart", "EUA", 30, 1.81, 105.7, 12, 2, 4);

$uec01 = new Luta();

$uec01-&gt;marcarLuta($l[0], $l[1]);
$uec01-&gt;lutar();

$uec01-&gt;getDesafiado()-&gt;status();
$uec01-&gt;getDesafiante()-&gt;status();
</code>
</pre>

<p>Agora teste, mudando os números dos arrays para mudar as lutas, pra ver se podem ou não acontecer e etc.</p>

<p>PS: Se houver uma agregação de objetos em classes, use o <code>unset</code> no objeto agregado dentro do destrutor (no caso o objeto Lutador seria destruído no destrutor da classe Luta).</p>

<p>Lembrando que, quando a gente inicia um objeto criado dentro da classe, na verdade se chama composição. No caso acima, caso a classe Luta fizesse a composição de Lutador, ela teria algo como <code>private $desafiado = new Lutador("Pretty Boy", "França", 30, 1.75, 68.9, 11, 2, 1);</code> dentro da classe Luta.</p>

<ul>
    <li><a href="tudo-sobre-poo-php-2.html">Parte Anterior da Matéria!</a></li>
    <li><a href="tudo-sobre-poo-php-4.html">Continuação da Matéria!</a></li>
</ul>
        </div>
    </body>
</html>