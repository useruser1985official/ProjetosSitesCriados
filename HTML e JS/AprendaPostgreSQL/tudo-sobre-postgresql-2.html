<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <meta charset="UTF-8"/>
        <link rel="icon" href="_imagens/favicon.ico"/>
        <title>Aprenda PostgreSQL</title>
        <link rel="stylesheet" href="_css/estilo.css"/>
    </head>
    <body>
        <div>
            <header>
                <h1>Aprenda PostgreSQL</h1>
                <menu>
                    <li><a href="index.html">Página Inicial</a></li>
                    <li><a href="contato.html">Contato!</a></li>
                    <li><a href="tudo-sobre-postgresql-1.html">Tudo sobre PostgreSQL Parte 1!</a></li>
                    <li><a href="tudo-sobre-postgresql-2.html" onclick="alert('Você já Está na Matéria desse Link!'); return false">Tudo sobre PostgreSQL Parte 2!</a></li>
                </menu>
            </header>
            
<h2>Tudo sobre PostgreSQL Parte 2</h2>

<h3>Ordenar Resultados de Consultas com Order By</h3>

<p>Podemos também ordenar os resultados de uma consulta por coluna, em ordem crescente ou decrescente.</p>

<p>Primeiramente, vamos inserir mais uns produtos na tabela, assim:</p>

<pre>
<code>
insert into produtos (codigo, nome, descricao, preco, qtd_estoque) values
(6, 'Detergente', 'Detergente líquido 500 ml', 1.89, 32),
(7, 'Leite Integral', 'Leite integral caixa de 1 litro', 4.60, 70),
(8, 'Refrigerante', 'Garrafa de refrigerante de 600 ml', 3.70, 14),
(9, 'Refrigerante', 'Garrafa de refrigerante de 1 litro', 6.89, 16),
(10, 'Refrigerante', 'Lata de refrigerante de 350 ml', 2.99, 45);

-- Esse insert é a parte, para vermos como funciona valores null,
-- pois a descrição não foi especificada.
insert into produtos (codigo, nome, preco, qtd_estoque) values (11, 'Margarina', 3.20, 8);

-- Depois dê esse select:
select * from produtos;
</code>
</pre>

<p>Para pegar os valores ordenados, faça assim:</p>

<pre>
<code>
select * from produtos order by nome; -- Por padrão, ele ordena em ordem crescente
</code>
</pre>

<p>Invertendo a ordem, com outra coluna:</p>

<pre>
<code>
select * from produtos order by qtd_estoque desc;
</code>
</pre>

<p>Podemos filtrar também, dessa forma:</p>

<pre>
<code>
select nome, preco from produtos order by nome;
</code>
</pre>

<p>Note que os refrigerante ficaram fora de ordem de preços, para isso, fazemos uma segunda ordenação dentro da primeira:</p>

<pre>
<code>
select nome, preco from produtos order by nome, preco;
</code>
</pre>

<p>No caso, ele ordenará primeiro por nome, e dentro dos nomes, por preço.</p>

<p>Faça essa ordenação:</p>

<pre>
<code>
select nome, descricao from produtos order by descricao;
</code>
</pre>

<p>Note que o último item é a margarina, que está com o valor null. Para os valores null aparecer antes, faça assim:</p>

<pre>
<code>
select nome, descricao from produtos order by descricao nulls first; -- Pode ser last também
</code>
</pre>

<p>Podemos usar o order junto com o where também, por exemplo:</p>

<pre>
<code>
select nome, preco from produtos where preco &gt; 10.00 order by preco asc;

-- Invertendo a ordem:
select nome, preco from produtos where preco &gt; 10.00 order by preco desc;
</code>
</pre>

<p>PS: O order vem depois do where.</p>

<h3>Limit e Offset - Limitar Resultados de Consultas</h3>

<p>O limit e o offset permitem obter uma parte específica das linhas retornadas por uma consulta SQL.</p>

<p>É recomendado usar o order by com o limit e o offset, mas ele não é obrigatório.</p>

<p>Vamos ver todos os produtos cadastrados:</p>

<pre>
<code>
select * from produtos order by preco;
</code>
</pre>

<p>Para vermos os quatro produtos mais baratos:</p>

<pre>
<code>
select * from produtos order by preco limit 4;
</code>
</pre>

<p>Nesse caso acima ele só mostrará os quatro produtos mais baratos.</p>

<p>Para visualizarmos do terceiro ao quinto mais caro, usamos o offset dessa forma:</p>

<pre>
<code>
select * from produtos order by preco desc limit 3 offset 2; -- Desconsidera os dois primeiros, contando a partir do terceiro.
</code>
</pre>

<p>O offset pode ser usado sem depender do limit, nesse comando ele mostra a partir do terceiro até o fim:</p>

<pre>
<code>
select * from produtos order by preco desc offset 2;
</code>
</pre>

<p>Os valores padrões dos comandos limit e offset são <code>all</code> e <code>0</code>, respectivamente, mas estes são dispensáveis colocar, geralmente.</p>

<p>Ao usar o limit sem o order, pode dar alguns problemas da exibição, por exemplo:</p>

<pre>
<code>
select * from produtos limit 5;
</code>
</pre>

<p>No caso acima, ele ordena pelo valor padrão, que é a chave primária.</p>

<h3>Operadores de Comparação em Consultas SQL</h3>

<p>Os operadores de comparação são usados para comparar dois valores e retornar um valor booleano, dependendo do resultado da comparação. Os operadores são os mesmos da maioria das linguagens de programação: <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>=</code> (nesse caso é um igual só) e <code>!=</code> (ou <code>&lt;&gt;</code>).</p>

<p>Vamos ver um exemplo de consulta SQL com isso:</p>

<pre>
<code>
select nome, preco from produtos where preco &gt; 12.00;
</code>
</pre>

<p>Outro exemplo:</p>

<pre>
<code>
select nome, qtd_estoque from produtos where qtd_estoque &lt;= 20;
</code>
</pre>

<p>Mais um, com o operador lógico <code>and</code>:</p>

<pre>
<code>
select nome, qtd_estoque from produtos where qtd_estoque &lt;= 20 and qtd_estoque &gt; 10;
</code>
</pre>

<p>Podemos também usar os operadores lógicos <code>or</code> e <code>not</code>, mas veremos isso mais pra frente.</p>

<p>Vamos trazer todos os produtos:</p>

<pre>
<code>
select nome, qtd_estoque from produtos;
</code>
</pre>

<p>Para não mostrar nenhum cadastro de refrigerante, fazemos assim:</p>

<pre>
<code>
select nome, qtd_estoque from produtos where nome != 'Refrigerante';
</code>
</pre>

<h3>Operador Between e Intervalos em Consultas SQL</h3>

<p>O operador <code>between</code> permite visualizar os cadastros dentro de um intervalo especificado dentro do mesmo. Ele é usado em conjunto com o <code>and</code>. Podemos usar também uma negação com <code>not</code> para ele não mostrar dados dentro do intervalo especificado.</p>

<p>Veja uma consulta padrão numa tabela:</p>

<pre>
<code>
select * from produtos;
</code>
</pre>

<p>Veja o uso dos operadores, com a cláusula where:</p>

<pre>
<code>
select nome, preco from produtos where preco between 10.00 and 20.00;
</code>
</pre>

<p>Mais um exemplo:</p>

<pre>
<code>
select nome, preco from produtos where
preco between 3.50 and 5.00 or
preco between 10.00 and 20.00;
</code>
</pre>

<p>Outro exemplo:</p>

<pre>
<code>
select nome, preco, qtd_estoque from produtos where
preco between 2.00 and 6.00 and
qtd_estoque &lt; 10;
</code>
</pre>

<p>Também podemos usar negação, dessa forma:</p>

<pre>
<code>
select nome, preco, qtd_estoque from produtos
where preco between 5.00 and 12.00;

-- Com negação:
select nome, preco, qtd_estoque from produtos
where preco not between 5.00 and 12.00;
</code>
</pre>

<ul>
    <li><a href="tudo-sobre-postgresql-1.html">Parte Anterior da Matéria!</a></li>
    <!--<li><a href="tudo-sobre-postgresql-3.html">Continuação da Matéria!</a></li>-->
</ul>
        </div>
    </body>
</html>