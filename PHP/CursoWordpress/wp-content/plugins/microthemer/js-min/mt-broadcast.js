if(BroadcastChannel){var thisTarget=window.TvrMT?"MTinterface":"outsideTab",isMTinterface="MTinterface"===thisTarget;MTBroadCast={BroadcastChannel:!1,observer:!1,thisTarget:thisTarget,isMTinterface:isMTinterface,isOutsideTab:!isMTinterface,actionWhenVisible:!1,MTDynFrontData:!1,stat:{},init:function(e){MTBroadCast.log("This window",window),MTBroadCast.isOutsideTab&&e&&(this.MTDynFrontData=e,this.listenForBuilderPublish()),this.createBroadcastChannel(),document.addEventListener("visibilitychange",MTBroadCast.visibilityChanged),this.BroadcastChannel.onmessage=function(e){if(e){var t=e.data;t&&t.update&&t.updateTarget===MTBroadCast.thisTarget&&(MTBroadCast.log("Message received in valid context",t),(t.asset_loading_change||t.adjusted_logic)&&(MTBroadCast.asset_loading_change=!0),MTBroadCast.tabIsHidden()?(MTBroadCast.log("Cache action for later",t),MTBroadCast.actionWhenVisible=t):(MTBroadCast.log("Run action right away",t),MTBroadCast.runAction(t)))}}},log:function(){},runAction:function(e){MTBroadCast.update[e.update](e),MTBroadCast.actionWhenVisible=!1},tabIsHidden:function(){return"hidden"===document.visibilityState},visibilityChanged:function(){"visible"===document.visibilityState?setTimeout((function(){MTBroadCast.log("This tab became visible"),MTBroadCast.actionWhenVisible&&MTBroadCast.runAction(MTBroadCast.actionWhenVisible)}),20):MTBroadCast.log("This tab became hidden")},createBroadcastChannel:function(){this.BroadcastChannel=new BroadcastChannel("microthemer"),MTBroadCast.log("createBroadcastChannel",this.BroadcastChannel)},broadcastChange:function(e){this.BroadcastChannel||this.createBroadcastChannel(),MTBroadCast.log("postMessage",e),this.BroadcastChannel.postMessage(e)},closeBroadcast:function(){this.BroadcastChannel.close(),this.BroadcastChannel=!1,document.removeEventListener("visibilitychange",MTBroadCast.visibilityChanged)},toggleSyncBrowserTabs:function(e){e?MTBroadCast.init():MTBroadCast.closeBroadcast()},observeTarget:function(e,t){t.observerConfig=t.observerConfig||{};var a=new MutationObserver((function(a){a.forEach((function(a){t.item.apply(this,[e,a].concat(t.args||[]))}))}));a.observe(e,t.observerConfig),MTBroadCast.observer=a},disconnectObserver:function(){MTBroadCast.observer.disconnect()},docReady:function(e){"complete"===document.readyState||"interactive"===document.readyState?setTimeout(e,1):document.addEventListener("DOMContentLoaded",e)},observeDomChange:function(e,t,a,o,n){a=a||document,o=o||"class";var s=(n=n||{}).el||a.querySelector(e);MTBroadCast.log("We have observeDomChange",e,t,a,s,n),s&&(MTBroadCast.log("We have an el",s,s.dataset),MTBroadCast.observeTarget(s,{observerConfig:{attributeFilter:[o],attributeOldValue:n.attributeOldValue,subtree:n.subtree,childList:n.childList},item:function(e,a){if(MTBroadCast.log("The mutation",a),"class"===o&&(!n.attributeOldValue&&e.classList.contains(t)||n.attributeOldValue&&a.oldValue.match(n.attributeOldValue))||"style"===o&&e[o][t.property]===t.value||"dataset"===n.change&&e[n.change][t.key]===t.value&&!n.attributeOldValue||a.oldValue===n.attributeOldValue||"disabled"===o&&e.disabled===t||("addedNodes"===o||"removedNodes"===o)&&a[o].length&&a[o][0].classList&&a[o][0].classList.contains(t)){if(MTBroadCast.log("Some kind of update happened in a Builder",n),n.isGutenberg&&n.customCallback)return void n.customCallback.item.apply(this,n.customCallback.args||[]);delete n.el,MTBroadCast.BroadcastChannel.postMessage({update:"sitePreview",updateTarget:"MTinterface",MTDynFrontData:MTBroadCast.MTDynFrontData,config:n}),n.cb&&n.cb.item.apply(this,n.args||[])}}}))},listenForBuilderPublish:function(){MTBroadCast.docReady((function(){MTBroadCast.stat.body=document.body;var e=document.body.dataset,t=!1,a=!1,o=!1,n=document.body.classList;MTBroadCast.log("The bodyData",e),document.documentElement.classList.contains("et-fb-app-frame")&&(t="divi"),e.hasOwnProperty("builderMode")?t="bricks":n.contains("brz-ed")?t="brizy":n.contains("znpb-editor-preview")?t="zion":"wppb-page-builder"===document.body.id?t="wppb":document.getElementById("breakdance_canvas")?t="breakdance":document.documentElement.dataset.op3Layer?t="optimizePress":n.contains("tve_editor_page")?t="thrive":n.contains("site-editor-php")||n.contains("block-editor-page")?t="gutenberg":e.hasOwnProperty("elementorDeviceMode")?t="elementor":document.documentElement.classList.contains("fl-builder-is-showing-toolbar")?t="FLBuilder":"CTFrontendBuilder"===document.documentElement.getAttribute("ng-app")&&(t="oxygen"),t&&(MTBroadCast.log("We have a builder",t),a=MTBroadCast[t].click,o=MTBroadCast[t].observe,a&&document.addEventListener("click",a),o&&o())}))},divi:{observe:function(){setTimeout((function(){MTBroadCast.observeDomChange("button.et-fb-button--save-draft",!1,window.parent.document,"disabled"),MTBroadCast.observeDomChange("button.et-fb-button--publish",!1,window.parent.document,"disabled")}),4e3)}},bricks:{observe:function(){MTBroadCast.observeDomChange("#bricks-preview-message","show")}},brizy:{observe:function(){setTimeout((function(){MTBroadCast.observeDomChange("div.brz-ed-fixed-bottom-panel__btn svg.brz-icon-svg","brz-d-none",window.parent.document)}),2e3)}},zion:{observe:function(){MTBroadCast.observeDomChange(".znpb-editor-header__page-save-wrapper--save","znpb-editor-icon-wrapper",window.parent.document,"addedNodes",{subtree:!0,childList:!0})}},wppb:{observe:function(){setTimeout((function(){MTBroadCast.observeDomChange("#wppb-builder-page-tools","wppb-toastr-success",window.parent.document,"addedNodes",{subtree:!0,childList:!0})}),2e3)}},breakdance:{observe:function(){setTimeout((function(){MTBroadCast.observeDomChange('button[data-test-id="main-save-button"]',"v-btn__loader",window.parent.document,"removedNodes",{subtree:!0,childList:!0})}),2e3)}},optimizePress:{observe:function(){setTimeout((function(){var e=window.parent.document;MTBroadCast.observeDomChange(!1,{key:"op3ButtonStatus",value:"success"},e,"data-op3-button-status",{el:e.getElementById("header").querySelector("a.save"),attributeOldValue:"pending",change:"dataset"})}),2e3)}},thrive:{observe:function(){var e=window.parent.document;MTBroadCast.observeDomChange(!1,!1,e,"class",{el:e.getElementById("tcb-editor-settings").querySelector("a.save"),attributeOldValue:"tve-disabled"})}},elementor:{observe:function(){MTBroadCast.observeDomChange("#elementor-panel-saver-button-publish","elementor-disabled",window.parent.document)}},FLBuilder:{observe:function(){MTBroadCast.observeDomChange("div.fl-builder-bar","is-hidden",window.parent.document)}},oxygen:{observe:function(){MTBroadCast.observeDomChange("#ct-page-overlay",{property:"display",value:"none"},window.parent.document,"style")}},gutenberg:{isObserving:!1,observeSaveOrPublish:function(e,t){e=e||document,MTBroadCast.observeDomChange(!1,!1,e,!1,{el:e.querySelectorAll("div.edit-post-header__settings button:first-of-type, button.editor-post-save-draft, button.editor-post-saved-state")[0],attributeOldValue:"is-saving",isGutenberg:1,customCallback:t}),MTBroadCast.observeDomChange("button.editor-post-publish-button__button",!1,e,!1,{el:e.querySelectorAll("button.edit-site-save-button__button, button.editor-post-publish-button__button")[0],attributeOldValue:"is-busy",isGutenberg:1,customCallback:t})},observe:function(){setTimeout((function(){MTBroadCast.gutenberg.observeSaveOrPublish()}),3e3)}},fetch:function(e,t){fetch(e).then((e=>e.json())).then((e=>{if(MTBroadCast.log("We fetched some data",e,t),t.cb){let a=t.cb.args||[];a.unshift(e),MTBroadCast.log("Running fetch callback",t.cb),t.cb.item.apply(this,a)}})).catch((e=>{console.error("Error:",e)}))},append_url_param:function(e,t,a,o){if(e.indexOf(t)>-1)return void 0!==a&&o?e.replace(RegExp(t+"=[^&]+"),t+"="+a):e;var n=e.indexOf("?")>-1?"&":"?";return e+n+(t=a?t+"="+a:t)},isSamePage:function(e,t){var a=decodeURIComponent(e["iframe-url"]),o=decodeURIComponent(t["iframe-url"]);return e.post_id===t.post_id&&e.isAdminArea===t.isAdminArea||a===o},assetLoadingChanged:function(e,t,a){let o=JSON.stringify(e)!==JSON.stringify(t),n=document.getElementById("microthemer_g_font-css")?1:0,s=document.getElementById("microthemer-css")?1:0,r=n!==parseInt(a.global_g_fonts),i=s!==parseInt(a.global_css);return MTBroadCast.log("assetLoadingChanged",o,i,r),o||i||r},assetLoadingConfig:function(e,t,a,o){let n,s={},r=t.asset_loading,i=r.logic,d=o?"not all":"all";r.global_g_fonts&&(n="microthemer_g_font-css",s[n]={assetHtml:MTBroadCast.generateAssetHTML(n,{media:d,css_external:1,url:t.gfURL},t,a)}),r.global_css&&(n="microthemer-css",s[n]={assetHtml:MTBroadCast.generateAssetHTML(n,{media:d,css_external:1,url:t.mtURL},t,a)});for(let r=0;r<i.length;r++){let d=i[r],l=d.slug;n="microthemer-"+l+"-css",e[l]&&(s[n]=d,d.media=o&&"blocksOnly"===e[l]?"not all":"all",s[n].assetHtml=MTBroadCast.generateAssetHTML(n,d,t,a))}return MTBroadCast.log("The asset loading config",s),s},generateAssetHTML:function(e,t,a,o){let n='<link rel="stylesheet" id="'+e+'" media="'+(t.media||"all")+'"',s=t.css_async?'as="style" onload="this.onload=null;this.rel=\'stylesheet\'"':"",r=t.css_external?"":' data-mt-notice="To support browser tab syncing, we converted a style element to this link element (for admin users only)"';return n+' href="'+(t.url||a.microUrl+"mt/conditional/draft/"+t.slug+".css?nomtcache="+o)+'" '+s+r+">"},allCSSAssetHTML:function(e){let t="",a=Object.keys(e);for(let o=0;o<a.length;o++)t+=e[a[o]].assetHtml;return t},update:{css:function(e){let t=MTBroadCast.asset_loading_change||e.asset_loading_change;if(MTBroadCast.log("checkAssetLoadingChange",t),t&&!MTBroadCast.isSamePage(e.MTDynFrontData,window.MTDynFrontData)){let a=MTBroadCast.append_url_param(decodeURIComponent(window.MTDynFrontData["iframe-url"]),"test_logic",1)+"&test_all=1";MTBroadCast.log("We need to fetch the logic for alt page",a),MTBroadCast.fetch(a,{cb:{item:MTBroadCast.update.action_css,args:[t,e]}})}else MTBroadCast.log("There was no asset loading change, or we have an up to date folderLoading value from MT"),MTBroadCast.update.action_css(e.MTDynFrontData.folderLoading,t,e)},action_css:function(e,t,a){MTBroadCast.log("Data passed to action_css",window,e,t,a);let o=(new Date).getTime(),n=!(!window.MTDynFrontData||!window.MTDynFrontData.folderLoading)&&window.MTDynFrontData.folderLoading,s=window.MTblock&&"editor"===window.MTblock.context,r=!!t&&MTBroadCast.assetLoadingChanged(n,e,a.asset_loading),i=document.querySelectorAll('link[href*="\\/micro-themes\\/"], link[id^="microthemer"], style[id^="microthemer"]'),d=document.getElementById("mt-placeholder-inline-css"),l=MTBroadCast.assetLoadingConfig(e,a,o,s);if(r){MTBroadCast.log("There has been an asset loading change for the current page",s,l);for(let e=0;e<i.length;e++)i[e].remove();d.insertAdjacentHTML("afterend",MTBroadCast.allCSSAssetHTML(l)),window.MTDynFrontData&&(window.MTDynFrontData.folderLoading=e)}else{MTBroadCast.log("No asset loading change, just update cache param / change to link");for(let e=0;e<i.length;e++){let t=i[e];if("STYLE"===t.tagName){let e=t.id.replace("inline-","");MTBroadCast.log("Change to style",e,l[e]),t.insertAdjacentHTML("afterend",l[e].assetHtml),t.remove()}else t.href=MTBroadCast.append_url_param(t.href,"nomtcache",o,!0),MTBroadCast.log("Refreshed param",t.href)}}MTBroadCast.asset_loading_change=!1},sitePreview:function(e){MTBroadCast.log("Received message to reload the site preview",e);var t=window.TvrMT,a=t.MTF,o=(t.TvrUi,t.TvrCom),n=e.config||{};(a&&MTBroadCast.isSamePage(a.getMTDynFrontData(),e.MTDynFrontData)||n.isGutenberg)&&(MTBroadCast.log("Conditions valid to reload the site preview",e),o.reload_current_frontend_page(a))}}}}