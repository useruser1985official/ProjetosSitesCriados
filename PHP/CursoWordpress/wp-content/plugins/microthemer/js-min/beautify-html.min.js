!function(){function t(t){return t.replace(/\s+$/g,"")}function e(e,s,r,a){var h,o,_,u,p,l,c,d,f,g,b,m,w,v,y,T,k,x,A,N,E;for(s=function(t,e){var n,i={};for(n in t)n!==e&&(i[n]=t[n]);if(e in t)for(n in t[e])i[n]=t[e][n];return i}(s=s||{},"html"),void 0!==s.wrap_line_length&&0!==parseInt(s.wrap_line_length,10)||void 0===s.max_char||0===parseInt(s.max_char,10)||(s.wrap_line_length=s.max_char),o=void 0!==s.indent_inner_html&&s.indent_inner_html,_=void 0===s.indent_body_inner_html||s.indent_body_inner_html,u=void 0===s.indent_head_inner_html||s.indent_head_inner_html,p=void 0===s.indent_size?4:parseInt(s.indent_size,10),l=void 0===s.indent_char?" ":s.indent_char,d=void 0===s.brace_style?"collapse":s.brace_style,c=0===parseInt(s.wrap_line_length,10)?32786:parseInt(s.wrap_line_length||250,10),f=s.unformatted||["a","abbr","area","audio","b","bdi","bdo","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","i","iframe","img","input","ins","kbd","keygen","label","map","mark","math","meter","noscript","object","output","progress","q","ruby","s","samp","select","small","span","strong","sub","sup","svg","template","textarea","time","u","var","video","wbr","text","acronym","address","big","dt","ins","strike","tt"],g=s.content_unformatted||["pre"],b=void 0===s.preserve_newlines||s.preserve_newlines,m=b?isNaN(parseInt(s.max_preserve_newlines,10))?32786:parseInt(s.max_preserve_newlines,10):0,w=void 0!==s.indent_handlebars&&s.indent_handlebars,v=void 0===s.wrap_attributes?"auto":s.wrap_attributes,y=isNaN(parseInt(s.wrap_attributes_indent_size,10))?p:parseInt(s.wrap_attributes_indent_size,10),T="force"===v.substr(0,5),k="force-expand-multiline"===v,x="force-aligned"===v,A=void 0!==s.end_with_newline&&s.end_with_newline,N="object"==typeof s.extra_liners&&s.extra_liners?s.extra_liners.concat():"string"==typeof s.extra_liners?s.extra_liners.split(","):"head,body,/html".split(","),E=s.eol?s.eol:"auto",s.indent_with_tabs&&(l="\t",p=1),"auto"===E&&(E="\n",e&&n.test(e||"")&&(E=e.match(n)[0])),E=E.replace(/\\r/,"\r").replace(/\\n/,"\n"),e=e.replace(i,"\n"),h=new function(){return this.pos=0,this.token="",this.current_mode="CONTENT",this.tags={parent:"parent1",parentcount:1,parent1:""},this.tag_type="",this.token_text=this.last_token=this.last_text=this.token_type="",this.newlines=0,this.indent_content=o,this.indent_body_inner_html=_,this.indent_head_inner_html=u,this.Utils={whitespace:"\n\r\t ".split(""),single_token:["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr","!doctype","?xml","?php","basefont","isindex"],extra_liners:N,in_array:function(t,e){for(var n=0;n<e.length;n++)if(t===e[n])return!0;return!1}},this.is_whitespace=function(t){for(var e=0;e<t.length;e++)if(!this.Utils.in_array(t.charAt(e),this.Utils.whitespace))return!1;return!0},this.traverse_whitespace=function(){var t="";if(t=this.input.charAt(this.pos),this.Utils.in_array(t,this.Utils.whitespace)){for(this.newlines=0;this.Utils.in_array(t,this.Utils.whitespace);)b&&"\n"===t&&this.newlines<=m&&(this.newlines+=1),this.pos++,t=this.input.charAt(this.pos);return!0}return!1},this.space_or_wrap=function(t){return this.line_char_count>=this.wrap_line_length?(this.print_newline(!1,t),this.print_indentation(t),!0):(this.line_char_count++,t.push(" "),!1)},this.get_content=function(){for(var t="",e=[],n=0;"<"!==this.input.charAt(this.pos)||2===n;){if(this.pos>=this.input.length)return e.length?e.join(""):["","TK_EOF"];if(n<2&&this.traverse_whitespace())this.space_or_wrap(e);else{if(t=this.input.charAt(this.pos),w){if("{"===t?n+=1:n<2&&(n=0),"}"===t&&n>0&&0==n--)break;var i=this.input.substr(this.pos,3);if("{{#"===i||"{{/"===i)break;if("{{!"===i)return[this.get_tag(),"TK_TAG_HANDLEBARS_COMMENT"];if("{{"===this.input.substr(this.pos,2)&&"{{else}}"===this.get_tag(!0))break}this.pos++,this.line_char_count++,e.push(t)}}return e.length?e.join(""):""},this.get_contents_to=function(t){if(this.pos===this.input.length)return["","TK_EOF"];var e="",n=new RegExp("</"+t+"\\s*>","igm");n.lastIndex=this.pos;var i=n.exec(this.input),s=i?i.index:this.input.length;return this.pos<s&&(e=this.input.substring(this.pos,s),this.pos=s),e},this.record_tag=function(t){this.tags[t+"count"]?(this.tags[t+"count"]++,this.tags[t+this.tags[t+"count"]]=this.indent_level):(this.tags[t+"count"]=1,this.tags[t+this.tags[t+"count"]]=this.indent_level),this.tags[t+this.tags[t+"count"]+"parent"]=this.tags.parent,this.tags.parent=t+this.tags[t+"count"]},this.retrieve_tag=function(t){if(this.tags[t+"count"]){for(var e=this.tags.parent;e&&t+this.tags[t+"count"]!==e;)e=this.tags[e+"parent"];e&&(this.indent_level=this.tags[t+this.tags[t+"count"]],this.tags.parent=this.tags[e+"parent"]),delete this.tags[t+this.tags[t+"count"]+"parent"],delete this.tags[t+this.tags[t+"count"]],1===this.tags[t+"count"]?delete this.tags[t+"count"]:this.tags[t+"count"]--}},this.indent_to_tag=function(t){if(this.tags[t+"count"]){for(var e=this.tags.parent;e&&t+this.tags[t+"count"]!==e;)e=this.tags[e+"parent"];e&&(this.indent_level=this.tags[t+this.tags[t+"count"]])}},this.get_tag=function(t){var e,n,i,s="",r=[],a="",h=!1,o=!0,_=!1,u=this.pos,p=this.line_char_count,l=!1;t=void 0!==t&&t;do{if(this.pos>=this.input.length)return t&&(this.pos=u,this.line_char_count=p),r.length?r.join(""):["","TK_EOF"];if(s=this.input.charAt(this.pos),this.pos++,this.Utils.in_array(s,this.Utils.whitespace))h=!0;else{if("'"!==s&&'"'!==s||(s+=this.get_unformatted(s),h=!0),"="===s&&(h=!1),i=this.input.substr(this.pos-1),!k||!_||l||">"!==s&&"/"!==s||i.match(/^\/?\s*>/)&&(h=!1,l=!0,this.print_newline(!1,r),this.print_indentation(r)),r.length&&"="!==r[r.length-1]&&">"!==s&&h){var c=this.space_or_wrap(r)&&"/"!==s&&!T;if(h=!1,T&&"/"!==s){var d=!1;k&&o&&(d=!(null!==i.match(/^\S*(="([^"]|\\")*")?\s*\/?\s*>/))),o&&!d||(this.print_newline(!1,r),this.print_indentation(r),c=!0)}if(c){_=!0;var b=y;x&&(b=r.indexOf(" ")+1);for(var m=0;m<b;m++)r.push(" ")}if(o)for(var v=0;v<r.length;v++)if(" "===r[v]){o=!1;break}}if(w&&"<"===n&&s+this.input.charAt(this.pos)==="{{"&&(s+=this.get_unformatted("}}"),r.length&&" "!==r[r.length-1]&&"<"!==r[r.length-1]&&(s=" "+s),h=!0),"<"!==s||n||(e=this.pos-1,n="<"),w&&!n&&r.length>=2&&"{"===r[r.length-1]&&"{"===r[r.length-2]&&(e="#"===s||"/"===s||"!"===s?this.pos-3:this.pos-2,n="{"),this.line_char_count++,r.push(s),r[1]&&("!"===r[1]||"?"===r[1]||"%"===r[1])){r=[this.get_comment(e)];break}if(w&&r[1]&&"{"===r[1]&&r[2]&&"!"===r[2]){r=[this.get_comment(e)];break}if(w&&"{"===n&&r.length>2&&"}"===r[r.length-2]&&"}"===r[r.length-1])break}}while(">"!==s);var A,N,E=r.join("");A=-1!==E.indexOf(" ")?E.indexOf(" "):-1!==E.indexOf("\n")?E.indexOf("\n"):"{"===E.charAt(0)?E.indexOf("}"):E.indexOf(">"),N="<"!==E.charAt(0)&&w?"#"===E.charAt(2)?3:2:1;var O=E.substring(N,A).toLowerCase();return"/"===E.charAt(E.length-2)||this.Utils.in_array(O,this.Utils.single_token)?t||(this.tag_type="SINGLE"):w&&"{"===E.charAt(0)&&"else"===O?t||(this.indent_to_tag("if"),this.tag_type="HANDLEBARS_ELSE",this.indent_content=!0,this.traverse_whitespace()):this.is_unformatted(O,f)||this.is_unformatted(O,g)?(a=this.get_unformatted("</"+O+">",E),r.push(a),this.pos,this.tag_type="SINGLE"):"script"===O&&(-1===E.search("type")||E.search("type")>-1&&E.search(/\b(text|application|dojo)\/(x-)?(javascript|ecmascript|jscript|livescript|(ld\+)?json|method|aspect)/)>-1)?t||(this.record_tag(O),this.tag_type="SCRIPT"):"style"===O&&(-1===E.search("type")||E.search("type")>-1&&E.search("text/css")>-1)?t||(this.record_tag(O),this.tag_type="STYLE"):"!"===O.charAt(0)?t||(this.tag_type="SINGLE",this.traverse_whitespace()):t||("/"===O.charAt(0)?(this.retrieve_tag(O.substring(1)),this.tag_type="END"):(this.record_tag(O),"html"!==O.toLowerCase()&&(this.indent_content=!0),this.tag_type="START"),this.traverse_whitespace()&&this.space_or_wrap(r),this.Utils.in_array(O,this.Utils.extra_liners)&&(this.print_newline(!1,this.output),this.output.length&&"\n"!==this.output[this.output.length-2]&&this.print_newline(!0,this.output))),t&&(this.pos=u,this.line_char_count=p),r.join("")},this.get_comment=function(t){var e="",n=">",i=!1;this.pos=t;var s=this.input.charAt(this.pos);for(this.pos++;this.pos<=this.input.length&&((e+=s).charAt(e.length-1)!==n.charAt(n.length-1)||-1===e.indexOf(n));)!i&&e.length<10&&(0===e.indexOf("<![if")?(n="<![endif]>",i=!0):0===e.indexOf("<![cdata[")?(n="]]>",i=!0):0===e.indexOf("<![")?(n="]>",i=!0):0===e.indexOf("\x3c!--")?(n="--\x3e",i=!0):0===e.indexOf("{{!--")?(n="--}}",i=!0):0===e.indexOf("{{!")?5===e.length&&-1===e.indexOf("{{!--")&&(n="}}",i=!0):0===e.indexOf("<?")?(n="?>",i=!0):0===e.indexOf("<%")&&(n="%>",i=!0)),s=this.input.charAt(this.pos),this.pos++;return e},this.get_unformatted=function(t,e){if(e&&-1!==e.toLowerCase().indexOf(t))return"";var n="",i="",s=!0,r=function(t){var e="";return{add:function(n){var i=e+n.toLowerCase();e=i.length<=t.length?i:i.substr(i.length-t.length,t.length)},doesNotMatch:function(){return-1===e.indexOf(t)}}}(t);do{if(this.pos>=this.input.length)return i;if(n=this.input.charAt(this.pos),this.pos++,this.Utils.in_array(n,this.Utils.whitespace)){if(!s){this.line_char_count--;continue}if("\n"===n||"\r"===n){i+="\n",this.line_char_count=0;continue}}i+=n,r.add(n),this.line_char_count++,s=!0,w&&"{"===n&&i.length&&"{"===i.charAt(i.length-2)&&(i+=this.get_unformatted("}}"))}while(r.doesNotMatch());return i},this.get_token=function(){var t;if("TK_TAG_SCRIPT"===this.last_token||"TK_TAG_STYLE"===this.last_token){var e=this.last_token.substr(7);return"string"!=typeof(t=this.get_contents_to(e))?t:[t,"TK_"+e]}return"CONTENT"===this.current_mode?"string"!=typeof(t=this.get_content())?t:[t,"TK_CONTENT"]:"TAG"===this.current_mode?"string"!=typeof(t=this.get_tag())?t:[t,"TK_TAG_"+this.tag_type]:void 0},this.get_full_indent=function(t){return(t=this.indent_level+t||0)<1?"":Array(t+1).join(this.indent_string)},this.is_unformatted=function(t,e){if(!this.Utils.in_array(t,e))return!1;if("a"!==t.toLowerCase()||!this.Utils.in_array("a",e))return!0;var n=(this.get_tag(!0)||"").match(/^\s*<\s*\/?([a-z]*)\s*[^>]*>\s*$/);return!(n&&!this.Utils.in_array(n,e))},this.printer=function(e,n,i,s,r){this.input=e||"",this.input=this.input.replace(/\r\n|[\r\u2028\u2029]/g,"\n"),this.output=[],this.indent_character=n,this.indent_string="",this.indent_size=i,this.brace_style=r,this.indent_level=0,this.wrap_line_length=s,this.line_char_count=0;for(var a=0;a<this.indent_size;a++)this.indent_string+=this.indent_character;this.print_newline=function(e,n){this.line_char_count=0,n&&n.length&&(e||"\n"!==n[n.length-1])&&("\n"!==n[n.length-1]&&(n[n.length-1]=t(n[n.length-1])),n.push("\n"))},this.print_indentation=function(t){for(var e=0;e<this.indent_level;e++)t.push(this.indent_string),this.line_char_count+=this.indent_string.length},this.print_token=function(t){this.is_whitespace(t)&&!this.output.length||((t||""!==t)&&this.output.length&&"\n"===this.output[this.output.length-1]&&(this.print_indentation(this.output),t=function(t){return t.replace(/^\s+/g,"")}(t)),this.print_token_raw(t))},this.print_token_raw=function(e){this.newlines>0&&(e=t(e)),e&&""!==e&&(e.length>1&&"\n"===e.charAt(e.length-1)?(this.output.push(e.slice(0,-1)),this.print_newline(!1,this.output)):this.output.push(e));for(var n=0;n<this.newlines;n++)this.print_newline(n>0,this.output);this.newlines=0},this.indent=function(){this.indent_level++},this.unindent=function(){this.indent_level>0&&this.indent_level--}},this},h.printer(e,l,p,c,d);;){var O=h.get_token();if(h.token_text=O[0],h.token_type=O[1],"TK_EOF"===h.token_type)break;switch(h.token_type){case"TK_TAG_START":h.print_newline(!1,h.output),h.print_token(h.token_text),h.indent_content&&(!h.indent_body_inner_html&&h.token_text.match(/<body(?:.*)>/)||!h.indent_head_inner_html&&h.token_text.match(/<head(?:.*)>/)||h.indent(),h.indent_content=!1),h.current_mode="CONTENT";break;case"TK_TAG_STYLE":case"TK_TAG_SCRIPT":h.print_newline(!1,h.output),h.print_token(h.token_text),h.current_mode="CONTENT";break;case"TK_TAG_END":if("TK_CONTENT"===h.last_token&&""===h.last_text){var S=(h.token_text.match(/\w+/)||[])[0],K=null;h.output.length&&(K=h.output[h.output.length-1].match(/(?:<|{{#)\s*(\w+)/)),(null===K||K[1]!==S&&!h.Utils.in_array(K[1],f))&&h.print_newline(!1,h.output)}h.print_token(h.token_text),h.current_mode="CONTENT";break;case"TK_TAG_SINGLE":var C=h.token_text.match(/^\s*<([a-z-]+)/i);C&&h.Utils.in_array(C[1],f)||h.print_newline(!1,h.output),h.print_token(h.token_text),h.current_mode="CONTENT";break;case"TK_TAG_HANDLEBARS_ELSE":for(var G=!1,L=h.output.length-1;L>=0&&"\n"!==h.output[L];L--)if(h.output[L].match(/{{#if/)){G=!0;break}G||h.print_newline(!1,h.output),h.print_token(h.token_text),h.indent_content&&(h.indent(),h.indent_content=!1),h.current_mode="CONTENT";break;case"TK_TAG_HANDLEBARS_COMMENT":case"TK_CONTENT":h.print_token(h.token_text),h.current_mode="TAG";break;case"TK_STYLE":case"TK_SCRIPT":if(""!==h.token_text){h.print_newline(!1,h.output);var U,j=h.token_text,I=1;"TK_SCRIPT"===h.token_type?U="function"==typeof r&&r:"TK_STYLE"===h.token_type&&(U="function"==typeof a&&a),"keep"===s.indent_scripts?I=0:"separate"===s.indent_scripts&&(I=-h.indent_level);var R=h.get_full_indent(I);if(U){var z=function(){this.eol="\n"};z.prototype=s;var D=new z;j=U(j.replace(/^\s*/,R),D)}else{var M=j.match(/^\s*/)[0].match(/[^\n\r]*$/)[0].split(h.indent_string).length-1,P=h.get_full_indent(I-M);j=j.replace(/^\s*/,R).replace(/\r\n|\r|\n/g,"\n"+P).replace(/\s+$/,"")}j&&(h.print_token_raw(j),h.print_newline(!0,h.output))}h.current_mode="TAG";break;default:""!==h.token_text&&h.print_token(h.token_text)}h.last_token=h.token_type,h.last_text=h.token_text}var Y=h.output.join("").replace(/[\r\n\t ]+$/,"");return A&&(Y+="\n"),"\n"!==E&&(Y=Y.replace(/[\n]/g,E)),Y}var n=/\r\n|[\n\r\u2028\u2029]/,i=new RegExp(n.source,"g");if("function"==typeof define&&define.amd)define(["require","./beautify","./beautify-css"],(function(t){var n=t("./beautify"),i=t("./beautify-css");return{html_beautify:function(t,s){return e(t,s,n.js_beautify,i.css_beautify)}}}));else if("undefined"!=typeof exports){var s=require("./beautify.js"),r=require("./beautify-css.js");exports.html_beautify=function(t,n){return e(t,n,s.js_beautify,r.css_beautify)}}else"undefined"!=typeof window?window.html_beautify=function(t,n){return e(t,n,window.js_beautify,window.css_beautify)}:"undefined"!=typeof global&&(global.html_beautify=function(t,n){return e(t,n,global.js_beautify,global.css_beautify)});"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&(self.html_beautify=function(t,n){return e(t,n)})}();